# åŒ»ç–—å½±åƒæ¨¡å‹ç®¡ç†å¹³å° - ç»„ä»¶è®¾è®¡è§„èŒƒ

## ğŸ¯ ç»„ä»¶è®¾è®¡åŸåˆ™

### è®¾è®¡ç†å¿µ
- **ä¸€è‡´æ€§**: æ‰€æœ‰ç»„ä»¶ä¿æŒç»Ÿä¸€çš„è®¾è®¡è¯­è¨€å’Œäº¤äº’æ¨¡å¼
- **å¯å¤ç”¨æ€§**: ç»„ä»¶è®¾è®¡è¦è€ƒè™‘åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å¤ç”¨
- **å¯ç»´æŠ¤æ€§**: ç»„ä»¶ç»“æ„æ¸…æ™°ï¼Œä¾¿äºåç»­ç»´æŠ¤å’Œæ‰©å±•
- **æ€§èƒ½ä¼˜åŒ–**: åˆç†ä½¿ç”¨Vue 3çš„å“åº”å¼ç‰¹æ€§ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“

### æŠ€æœ¯è§„èŒƒ
- ä½¿ç”¨Vue 3 Composition API
- æ”¯æŒTypeScriptç±»å‹å®šä¹‰
- ä½¿ç”¨Element Plusä½œä¸ºåŸºç¡€UIç»„ä»¶
- éµå¾ªVue 3å®˜æ–¹æœ€ä½³å®è·µ

## ğŸ§© æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. MainLayout.vue - ä¸»å¸ƒå±€å®¹å™¨

#### ç»„ä»¶èŒè´£
- æä¾›ç³»ç»Ÿé¡µé¢çš„æ•´ä½“å¸ƒå±€ç»“æ„
- ç®¡ç†ä¾§è¾¹æ çš„å±•å¼€/æŠ˜å çŠ¶æ€
- åè°ƒHeaderã€Sidebarã€Contentç­‰å­ç»„ä»¶
- å¤„ç†å“åº”å¼å¸ƒå±€é€»è¾‘

#### ç»„ä»¶ç»“æ„
```vue
<template>
  <div class="main-layout" :class="{ 'sidebar-collapsed': isSidebarCollapsed }">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <Header 
      :is-sidebar-collapsed="isSidebarCollapsed"
      @toggle-sidebar="toggleSidebar"
    />
    
    <div class="layout-container">
      <!-- ä¾§è¾¹æ  -->
      <Sidebar 
        :is-collapsed="isSidebarCollapsed"
        @collapse="toggleSidebar"
      />
      
      <!-- ä¸»å†…å®¹åŒºåŸŸ -->
      <main class="main-content">
        <Breadcrumb />
        <div class="content-wrapper">
          <router-view />
        </div>
      </main>
    </div>
  </div>
</template>
```

#### Propså®šä¹‰
```typescript
interface MainLayoutProps {
  // æ— å¤–éƒ¨props
}

interface MainLayoutEmits {
  // æ— å¤–éƒ¨äº‹ä»¶
}
```

#### çŠ¶æ€ç®¡ç†
```typescript
// ä¾§è¾¹æ çŠ¶æ€
const isSidebarCollapsed = ref(false)

// å“åº”å¼æ–­ç‚¹
const isMobile = ref(false)
const isTablet = ref(false)

// æ–¹æ³•
const toggleSidebar = () => {
  isSidebarCollapsed.value = !isSidebarCollapsed.value
}
```

### 2. Header.vue - é¡¶éƒ¨å¯¼èˆªæ 

#### ç»„ä»¶èŒè´£
- æ˜¾ç¤ºç³»ç»ŸLogoå’Œæ ‡é¢˜
- æä¾›ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºå’Œæ“ä½œ
- åŒ…å«é€šçŸ¥ã€è®¾ç½®ç­‰å¿«æ·åŠŸèƒ½
- å“åº”å¼é€‚é…ä¸åŒå±å¹•å°ºå¯¸

#### ç»„ä»¶ç»“æ„
```vue
<template>
  <header class="app-header">
    <!-- å·¦ä¾§åŒºåŸŸ -->
    <div class="header-left">
      <button 
        class="menu-toggle"
        @click="$emit('toggle-sidebar')"
      >
        <el-icon><Menu /></el-icon>
      </button>
      
      <div class="logo-section">
        <img src="@/assets/logo.png" alt="Logo" class="logo" />
        <h1 class="system-title">åŒ»ç–—å½±åƒæ¨¡å‹ç®¡ç†å¹³å°</h1>
      </div>
    </div>
    
    <!-- å³ä¾§åŒºåŸŸ -->
    <div class="header-right">
      <!-- é€šçŸ¥ -->
      <el-badge :value="notificationCount" class="notification-badge">
        <el-button circle>
          <el-icon><Bell /></el-icon>
        </el-button>
      </el-badge>
      
      <!-- ç”¨æˆ·ä¿¡æ¯ -->
      <el-dropdown @command="handleUserCommand">
        <div class="user-info">
          <el-avatar :src="userAvatar" />
          <span class="username">{{ username }}</span>
        </div>
        <template #dropdown>
          <el-dropdown-menu>
            <el-dropdown-item command="profile">ä¸ªäººèµ„æ–™</el-dropdown-item>
            <el-dropdown-item command="settings">è®¾ç½®</el-dropdown-item>
            <el-dropdown-item divided command="logout">é€€å‡ºç™»å½•</el-dropdown-item>
          </el-dropdown-menu>
        </template>
      </el-dropdown>
      
      <!-- åŠŸèƒ½æŒ‰é’® -->
      <el-button circle @click="toggleTheme">
        <el-icon><Sunny /></el-icon>
      </el-button>
      
      <el-button circle @click="toggleFullscreen">
        <el-icon><FullScreen /></el-icon>
      </el-button>
    </div>
  </header>
</template>
```

#### Propså®šä¹‰
```typescript
interface HeaderProps {
  isSidebarCollapsed: boolean
}

interface HeaderEmits {
  toggleSidebar: []
}
```

#### åŠŸèƒ½ç‰¹æ€§
- å“åº”å¼Logoå’Œæ ‡é¢˜æ˜¾ç¤º
- ç”¨æˆ·å¤´åƒå’Œä¸‹æ‹‰èœå•
- é€šçŸ¥å¾½ç« æ˜¾ç¤º
- ä¸»é¢˜åˆ‡æ¢å’Œå…¨å±åˆ‡æ¢
- ç§»åŠ¨ç«¯é€‚é…

### 3. Sidebar.vue - ä¾§è¾¹æ å¯¼èˆª

#### ç»„ä»¶èŒè´£
- æä¾›ç³»ç»Ÿä¸»è¦åŠŸèƒ½æ¨¡å—çš„å¯¼èˆª
- æ”¯æŒå¤šçº§èœå•ç»“æ„
- ç®¡ç†èœå•çš„å±•å¼€/æŠ˜å çŠ¶æ€
- å¤„ç†è·¯ç”±è·³è½¬å’Œæƒé™æ§åˆ¶

#### èœå•æ•°æ®ç»“æ„
```typescript
interface MenuItem {
  id: string
  title: string
  icon: string
  path?: string
  children?: MenuItem[]
  permission?: string
  badge?: string | number
}

const menuItems: MenuItem[] = [
  {
    id: 'dashboard',
    title: 'æ§åˆ¶å°',
    icon: 'DataBoard',
    path: '/dashboard'
  },
  {
    id: 'user',
    title: 'ç”¨æˆ·ç®¡ç†',
    icon: 'User',
    children: [
      {
        id: 'user-list',
        title: 'ç”¨æˆ·åˆ—è¡¨',
        path: '/user/list'
      },
      {
        id: 'user-profile',
        title: 'ä¸ªäººèµ„æ–™',
        path: '/user/profile'
      }
    ]
  },
  {
    id: 'permission',
    title: 'æƒé™ç®¡ç†',
    icon: 'Lock',
    path: '/permission'
  },
  {
    id: 'credit',
    title: 'ç§¯åˆ†ç³»ç»Ÿ',
    icon: 'Wallet',
    path: '/credit'
  },
  {
    id: 'system',
    title: 'ç³»ç»Ÿé…ç½®',
    icon: 'Setting',
    path: '/system'
  },
  {
    id: 'model',
    title: 'æ¨¡å‹ç®¡ç†',
    icon: 'Cpu',
    path: '/model'
  }
]
```

#### ç»„ä»¶ç»“æ„
```vue
<template>
  <aside class="app-sidebar" :class="{ 'collapsed': isCollapsed }">
    <!-- èœå•åˆ—è¡¨ -->
    <nav class="sidebar-nav">
      <ul class="menu-list">
        <li 
          v-for="item in menuItems" 
          :key="item.id"
          class="menu-item"
          :class="{ 'active': isActive(item) }"
        >
          <!-- å•çº§èœå• -->
          <router-link 
            v-if="!item.children"
            :to="item.path"
            class="menu-link"
          >
            <el-icon><component :is="item.icon" /></el-icon>
            <span class="menu-title">{{ item.title }}</span>
            <el-badge 
              v-if="item.badge"
              :value="item.badge"
              class="menu-badge"
            />
          </router-link>
          
          <!-- å¤šçº§èœå• -->
          <div 
            v-else
            class="menu-group"
            @click="toggleSubmenu(item.id)"
          >
            <div class="menu-header">
              <el-icon><component :is="item.icon" /></el-icon>
              <span class="menu-title">{{ item.title }}</span>
              <el-icon class="arrow" :class="{ 'expanded': isSubmenuOpen(item.id) }">
                <ArrowDown />
              </el-icon>
            </div>
            
            <ul 
              v-show="isSubmenuOpen(item.id)"
              class="submenu-list"
            >
              <li 
                v-for="subItem in item.children"
                :key="subItem.id"
                class="submenu-item"
              >
                <router-link 
                  :to="subItem.path"
                  class="submenu-link"
                >
                  {{ subItem.title }}
                </router-link>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </nav>
    
    <!-- æŠ˜å æŒ‰é’® -->
    <div class="sidebar-footer">
      <el-button 
        circle
        @click="$emit('collapse')"
        class="collapse-btn"
      >
        <el-icon><Fold /></el-icon>
      </el-button>
    </div>
  </aside>
</template>
```

#### åŠŸèƒ½ç‰¹æ€§
- æ”¯æŒå•çº§å’Œå¤šçº§èœå•
- èœå•é¡¹é«˜äº®å’Œæ¿€æ´»çŠ¶æ€
- å­èœå•å±•å¼€/æŠ˜å åŠ¨ç”»
- æƒé™æ§åˆ¶æ”¯æŒ
- å¾½ç« æ˜¾ç¤ºæ”¯æŒ

### 4. Breadcrumb.vue - é¢åŒ…å±‘å¯¼èˆª

#### ç»„ä»¶èŒè´£
- æ˜¾ç¤ºå½“å‰é¡µé¢åœ¨ç³»ç»Ÿä¸­çš„ä½ç½®
- æ”¯æŒç‚¹å‡»è·³è½¬åˆ°ä¸Šçº§é¡µé¢
- åŠ¨æ€ç”Ÿæˆé¢åŒ…å±‘è·¯å¾„
- å“åº”å¼æ˜¾ç¤º

#### ç»„ä»¶ç»“æ„
```vue
<template>
  <nav class="breadcrumb-nav" v-if="breadcrumbItems.length > 0">
    <el-breadcrumb separator="/">
      <el-breadcrumb-item 
        v-for="(item, index) in breadcrumbItems"
        :key="index"
        :to="item.path"
        :class="{ 'current': index === breadcrumbItems.length - 1 }"
      >
        {{ item.title }}
      </el-breadcrumb-item>
    </el-breadcrumb>
  </nav>
</template>
```

#### é¢åŒ…å±‘ç”Ÿæˆé€»è¾‘
```typescript
// æ ¹æ®å½“å‰è·¯ç”±ç”Ÿæˆé¢åŒ…å±‘
const breadcrumbItems = computed(() => {
  const route = useRoute()
  const items = []
  
  // æ·»åŠ é¦–é¡µ
  items.push({
    title: 'é¦–é¡µ',
    path: '/dashboard'
  })
  
  // æ ¹æ®è·¯ç”±metaç”Ÿæˆé¢åŒ…å±‘
  if (route.meta.breadcrumb) {
    items.push(...route.meta.breadcrumb)
  }
  
  return items
})
```

## ğŸ¨ æ ·å¼è®¾è®¡è§„èŒƒ

### CSSç±»å‘½åè§„èŒƒ
```scss
// ä½¿ç”¨BEMå‘½åè§„èŒƒ
.main-layout {
  &__header { }
  &__sidebar { }
  &__content { }
  
  &--collapsed { }
  &--mobile { }
}

.app-header {
  &__left { }
  &__right { }
  &__logo { }
  &__title { }
}

.app-sidebar {
  &__nav { }
  &__menu { }
  &__item { }
  &__link { }
  &__footer { }
}
```

### å“åº”å¼æ–­ç‚¹
```scss
// æ–­ç‚¹å˜é‡
$breakpoints: (
  xs: 480px,
  sm: 768px,
  md: 992px,
  lg: 1200px,
  xl: 1920px
);

// åª’ä½“æŸ¥è¯¢æ··å…¥
@mixin respond-to($breakpoint) {
  @if map-has-key($breakpoints, $breakpoint) {
    @media (max-width: map-get($breakpoints, $breakpoint)) {
      @content;
    }
  }
}
```

### åŠ¨ç”»æ•ˆæœ
```scss
// è¿‡æ¸¡åŠ¨ç”»
.sidebar-transition {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

// æ‚¬åœæ•ˆæœ
.menu-item {
  &:hover {
    background-color: rgba(24, 144, 255, 0.1);
    transform: translateX(4px);
    transition: all 0.2s ease;
  }
}
```

## ğŸ”§ ç»„ä»¶é€šä¿¡è§„èŒƒ

### çˆ¶å­ç»„ä»¶é€šä¿¡
```typescript
// çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®
<Header :is-sidebar-collapsed="isSidebarCollapsed" />

// å­ç»„ä»¶å‘çˆ¶ç»„ä»¶å‘é€äº‹ä»¶
<Sidebar @collapse="handleSidebarCollapse" />
```

### è·¨ç»„ä»¶çŠ¶æ€å…±äº«
```typescript
// ä½¿ç”¨Pinia storeç®¡ç†å…¨å±€çŠ¶æ€
export const useLayoutStore = defineStore('layout', () => {
  const isSidebarCollapsed = ref(false)
  const isMobile = ref(false)
  
  const toggleSidebar = () => {
    isSidebarCollapsed.value = !isSidebarCollapsed.value
  }
  
  return {
    isSidebarCollapsed,
    isMobile,
    toggleSidebar
  }
})
```

### äº‹ä»¶æ€»çº¿ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
```typescript
// ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨äº‹ä»¶æ€»çº¿
import mitt from 'mitt'
const emitter = mitt()

// å‘é€äº‹ä»¶
emitter.emit('sidebar-toggle')

// ç›‘å¬äº‹ä»¶
emitter.on('sidebar-toggle', () => {
  // å¤„ç†äº‹ä»¶
})
```

## ğŸ“± å“åº”å¼è®¾è®¡è¦ç‚¹

### ç§»åŠ¨ç«¯é€‚é…
```scss
// ç§»åŠ¨ç«¯æ ·å¼
@include respond-to(sm) {
  .main-layout {
    &__sidebar {
      position: fixed;
      left: -100%;
      z-index: 1000;
      
      &.open {
        left: 0;
      }
    }
  }
  
  .app-header {
    &__title {
      display: none;
    }
  }
}
```

### è§¦æ‘¸å‹å¥½è®¾è®¡
```scss
// è§¦æ‘¸ç›®æ ‡å°ºå¯¸
.menu-link,
.menu-header {
  min-height: 44px;
  padding: 12px 16px;
}

// è§¦æ‘¸åé¦ˆ
.menu-item:active {
  background-color: rgba(24, 144, 255, 0.2);
}
```

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### å•å…ƒæµ‹è¯•
```typescript
// ç»„ä»¶æµ‹è¯•ç¤ºä¾‹
import { mount } from '@vue/test-utils'
import MainLayout from '@/components/MainLayout.vue'

describe('MainLayout', () => {
  it('should toggle sidebar when toggle button is clicked', async () => {
    const wrapper = mount(MainLayout)
    const toggleButton = wrapper.find('.menu-toggle')
    
    await toggleButton.trigger('click')
    
    expect(wrapper.vm.isSidebarCollapsed).toBe(true)
  })
})
```

### é›†æˆæµ‹è¯•
```typescript
// è·¯ç”±é›†æˆæµ‹è¯•
import { createRouter, createWebHistory } from 'vue-router'
import { mount } from '@vue/test-utils'

describe('Layout Integration', () => {
  it('should navigate to correct route when menu item is clicked', async () => {
    // æµ‹è¯•å®ç°
  })
})
```

---

*ç»„ä»¶è®¾è®¡è§„èŒƒç‰ˆæœ¬: v1.0*  
*åˆ›å»ºæ—¶é—´: 2025-01-15*  
*è®¾è®¡è€…: AIåŠ©æ‰‹* 